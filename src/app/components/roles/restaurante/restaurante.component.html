<div class="container mt-4">
  <div class="row" id="titulo">
    <div class="col text-center">
      <h2>Administración de Restaurantes</h2>
    </div>
  </div>

  <div class="row mt-4">
    <div class="col-md-8 mx-auto">
      <div class="card mb-4">
        <div class="card-body">
          <form [formGroup]="restauranteForm" *ngIf="!restauranteEditando">
            <div class="form-group">
              <label for="nombre">Nombre</label>
              <input type="text" class="form-control" id="nombre" formControlName="nombre">
            </div>
            <div class="form-group">
              <label for="direccion">Dirección</label>
              <input type="text" class="form-control" id="direccion" formControlName="direccion">
            </div>
            <div class="form-group">
              <label for="telefono">Teléfono</label>
              <input type="text" class="form-control" id="telefono" formControlName="telefono">
            </div>
            <div class="form-group">
              <label for="tipoCocina">Tipo de Cocina</label>
              <input type="text" class="form-control" id="tipoCocina" formControlName="tipoCocina">
            </div>
            <div class="form-group">
              <label for="capacidadPersonas">Capacidad de Personas</label>
              <input type="number" class="form-control" id="capacidadPersonas" formControlName="capacidadPersonas">
            </div>
            <div class="form-group">
              <label for="horaApertura">Hora de Apertura</label>
              <input type="time" class="form-control" id="horaApertura" formControlName="horaApertura">
            </div>
            <div class="form-group">
              <label for="horaCierre">Hora de Cierre</label>
              <input type="time" class="form-control" id="horaCierre" formControlName="horaCierre">
            </div>
            <div class="form-group">
              <label for="estado">Estado</label>
              <select class="form-control" id="estado" formControlName="estado">
                <option value="true">Activo</option>
                <option value="false">Inactivo</option>
              </select>
            </div>
            <div class="form-group">
              <label for="opcionImagen">Opción de Imagen</label>
              <div class="form-check">
                <input class="form-check-input" type="radio" id="subir" value="subir" [(ngModel)]="opcionImagen" name="opcionImagen" (change)="cambiarOpcionImagen('subir')" checked>
                <label class="form-check-label" for="subir">Subir Imagen</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" id="url" value="url" [(ngModel)]="opcionImagen" name="opcionImagen" (change)="cambiarOpcionImagen('url')">
                <label class="form-check-label" for="url">Pegar URL de Imagen</label>
              </div>
            </div>
            <div class="form-group" *ngIf="opcionImagen === 'url'">
              <label for="urlImagen">URL de Imagen</label>
              <input type="text" class="form-control" id="urlImagen" formControlName="urlImagen">
              <div *ngIf="imagenPreview">
                <img [src]="imagenPreview" alt="Vista Previa de la Imagen" class="img-thumbnail mt-2" style="max-width: 200px;">
              </div>
            </div>
            <div class="form-group" *ngIf="opcionImagen === 'subir'">
              <label for="imagenRestaurante">Subir Imagen de Restaurante</label>
              <input type="file" class="form-control-file" id="imagenRestaurante" formControlName="imagenRestaurante" (change)="onFileSelected($event)">
              <div *ngIf="imagenPreview">
                <img [src]="imagenPreview" alt="Vista Previa de la Imagen" class="img-thumbnail mt-2" style="max-width: 200px;">
              </div>
            </div>
            <button type="button" class="btn btn-primary" (click)="crearRestaurante()">Crear Restaurante</button>
            <button type="button" class="btn btn-success ml-2" (click)="exportCSVRestaurante()">Exportar CSV</button>
            <button type="button" class="btn btn-danger ml-2" (click)="generarReportePDFRestaurantes()">Exportar
              PDF</button>
          </form>

          <form [formGroup]="restauranteForm" *ngIf="restauranteEditando" class="mb-4">
            <input type="hidden" formControlName="id">
            <div class="form-group">
              <label for="nombre">Nombre</label>
              <input type="text" class="form-control" id="nombre" formControlName="nombre">
            </div>
            <div class="form-group">
              <label for="direccion">Dirección</label>
              <input type="text" class="form-control" id="direccion" formControlName="direccion">
            </div>
            <div class="form-group">
              <label for="telefono">Teléfono</label>
              <input type="text" class="form-control" id="telefono" formControlName="telefono">
            </div>
            <div class="form-group">
              <label for="tipoCocina">Tipo de Cocina</label>
              <input type="text" class="form-control" id="tipoCocina" formControlName="tipoCocina">
            </div>
            <div class="form-group">
              <label for="capacidadPersonas">Capacidad de Personas</label>
              <input type="number" class="form-control" id="capacidadPersonas" formControlName="capacidadPersonas">
            </div>
            <div class="form-group">
              <label for="horaApertura">Hora de Apertura</label>
              <input type="time" class="form-control" id="horaApertura" formControlName="horaApertura">
            </div>
            <div class="form-group">
              <label for="horaCierre">Hora de Cierre</label>
              <input type="time" class="form-control" id="horaCierre" formControlName="horaCierre">
            </div>
            <div class="form-group">
              <label for="estado">Estado</label>
              <select class="form-control" id="estado" formControlName="estado">
                <option value="true">Activo</option>
                <option value="false">Inactivo</option>
              </select>
            </div>
            <button type="button" class="btn btn-primary" (click)="guardarCambios()">Guardar Cambios</button>
            <button type="button" class="btn btn-danger ml-2" (click)="cancelarEdicion()">Cancelar</button>
          </form>
        </div>
      </div>
    </div>
<!-- Listado de restaurantes -->
<div class="card mb-4">
  <div class="card-header">
    <h2>Lista de Restaurantes</h2>
  </div>
  <div class="card-body">
    <div class="table-responsive">
      <table class="table table-striped table-hover">
        <thead>
          <tr>
            <th>Nombre</th>
            <th>Dirección</th>
            <th>Teléfono</th>
            <th>Tipo de Cocina</th>
            <th>Capacidad</th>
            <th>Horario</th>
            <th>Estado</th>
            <th>Imagen</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let restaurante of restaurantes | paginate: { itemsPerPage: 5, currentPage: p }">
            <td>{{ restaurante.nombre }}</td>
            <td>{{ restaurante.direccion }}</td>
            <td>{{ restaurante.telefono }}</td>
            <td>{{ restaurante.tipoCocina }}</td>
            <td>{{ restaurante.capacidadPersonas }}</td>
            <td>{{ restaurante.horarioFuncionamiento }}</td>
            <td>{{ restaurante.estado ? 'Activo' : 'Inactivo' }}</td>
            <td>
              <img *ngIf="restaurante.imagenRestaurante" [src]="restaurante.imagenRestaurante"
                alt="Imagen del Restaurante" class="img-thumbnail" style="max-width: 100px;">
            </td>
            <td>
              <button class="btn btn-warning btn-sm" (click)="editarRestaurante(restaurante)">Editar</button>
              <button class="btn btn-danger btn-sm" (click)="desactivarRestaurante(restaurante)"
                *ngIf="restaurante.estado">Desactivar</button>
              <button class="btn btn-success btn-sm" (click)="restaurarRestaurante(restaurante)"
                *ngIf="!restaurante.estado">Restaurar</button>
              <button class="btn btn-info btn-sm" (click)="verRestaurante(restaurante)">Ver Restaurante</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    <pagination-controls (pageChange)="p = $event"></pagination-controls>
  </div>
</div>

<!-- Detalles del restaurante seleccionado -->
<div *ngIf="restauranteSeleccionado" class="card mb-4">
  <div class="card-header">
    <h2>Detalles del Restaurante</h2>
  </div>
  <div class="card-body">
    <div class="row">
      <div class="col-md-8">
        <p><strong>Nombre:</strong> {{ restauranteSeleccionado.nombre }}</p>
        <p><strong>Dirección:</strong> {{ restauranteSeleccionado.direccion }}</p>
        <p><strong>Teléfono:</strong> {{ restauranteSeleccionado.telefono }}</p>
        <p><strong>Tipo de Cocina:</strong> {{ restauranteSeleccionado.tipoCocina }}</p>
        <p><strong>Capacidad de Personas:</strong> {{ restauranteSeleccionado.capacidadPersonas }}</p>
        <p><strong>Horario de Funcionamiento:</strong> {{ restauranteSeleccionado.horarioFuncionamiento }}</p>
        <p><strong>Estado:</strong> {{ restauranteSeleccionado.estado ? 'Activo' : 'Inactivo' }}</p>
        <!--<p><strong>ID del Gestor:</strong> {{ restauranteSeleccionado.docid }}</p>-->
      </div>
      <div class="col-md-4">
        <img *ngIf="restauranteSeleccionado.imagenRestaurante" [src]="restauranteSeleccionado.imagenRestaurante"
          alt="Imagen del Restaurante" class="img-fluid">
      </div>
    </div>
    <div class="text-center mt-3">
      <button class="btn btn-info" (click)="mostrarPresentacion()">Ver Presentación del Restaurante</button>
    </div>
  </div>
</div>

<!-- Presentación del restaurante -->
<div *ngIf="mostrarPresentacionRestaurante" class="card mb-4">
  <div class="card-header d-flex justify-content-between align-items-center">
    <h2>{{ restauranteSeleccionado.nombre }} - Presentación</h2>
    <button class="btn btn-danger" (click)="cerrarPresentacion()">Cerrar</button>
  </div>
  <div class="card-body">
    <div class="row">
      <div class="col-md-4 text-center">
        <img *ngIf="restauranteSeleccionado.imagenRestaurante" [src]="restauranteSeleccionado.imagenRestaurante"
          alt="Logo del Restaurante" class="img-fluid rounded-circle mb-3" style="max-width: 150px;">
        <p><i class="fas fa-map-marker-alt"></i> {{ restauranteSeleccionado.direccion }}</p>
        <p><i class="fas fa-users"></i> Capacidad: {{ restauranteSeleccionado.capacidadPersonas }} personas</p>
        <p><i class="fas fa-star"></i> Calificación: {{ restauranteSeleccionado.calificacion }} / 5</p>
        <p>
          <i class="fas fa-clock"></i> 
          <span [ngClass]="{'text-success': restauranteSeleccionado.estaAbierto, 'text-danger': !restauranteSeleccionado.estaAbierto}">
            {{ restauranteSeleccionado.estaAbierto ? 'Abierto' : 'Cerrado' }}: {{ restauranteSeleccionado.horarioApertura }} - {{ restauranteSeleccionado.horarioCierre }}
          </span>
        </p>
        <p><i class="fas fa-utensils"></i> Se especializa en: {{ restauranteSeleccionado.tipoCocina }}</p>
        <p><i class="fas fa-phone"></i> Teléfono: {{ restauranteSeleccionado.telefono }}</p>
      </div>
      <div class="col-md-8">
        <p><strong>Descripción:</strong> {{ restauranteSeleccionado.descripcion }}</p>
      </div>
    </div>

    <hr>

    <div class="mt-4">
      <h3><i class="fas fa-cocktail"></i> Sección Bebidas</h3>
      <button class="btn btn-primary mb-2" (click)="agregarBebida()"><i class="fas fa-plus"></i> Agregar Bebida</button>
      <div *ngFor="let bebida of bebidas" class="border p-3 mb-3">
        <p><strong>{{ bebida.nombre }}</strong> - {{ bebida.descripcion }}</p>
      </div>
    </div>

    <hr>

    <div class="mt-4">
      <h3><i class="fas fa-utensils"></i> Sección Platos a la Carta</h3>
      <button class="btn btn-primary mb-2" (click)="agregarPlatoCarta()"><i class="fas fa-plus"></i> Agregar Plato a la Carta</button>
      <div *ngFor="let plato of platosCarta" class="border p-3 mb-3">
        <p><strong>{{ plato.nombre }}</strong> - {{ plato.descripcion }}</p>
      </div>
    </div>

    <hr>

    <div class="mt-4">
      <h3><i class="fas fa-concierge-bell"></i> Sección Platos Menú</h3>
      <button class="btn btn-primary mb-2" (click)="agregarPlatoMenu()"><i class="fas fa-plus"></i> Agregar Plato Menú</button>
      <div *ngFor="let plato of platosMenu" class="border p-3 mb-3">
        <p><strong>{{ plato.nombre }}</strong> - {{ plato.descripcion }}</p>
      </div>
    </div>
  </div>
</div>



